#!/usr/bin/env python3
import os
import pyttsx3

def generate_voiceover():
    # Path to the script outline file generated by the Scriptwriting & 
Outline Agent
    outline_file = os.path.join(
        os.path.expanduser("~"),
        
"Documents/youtube/Agents/2_Scriptwriting_Outline_Agent/code/script_outline.txt"
    )
    
    # Check if the file exists
    if not os.path.exists(outline_file):
        print("Script outline file not found. Please run the Scriptwriting & 
        return
    
    # Read the script outline text
    with open(outline_file, "r") as f:
        text = f.read()
    
    print("Generating voiceover for the following text:")
    print(text)
    
    # Initialize the text-to-speech engine
    engine = pyttsx3.init()
    
    # Optional: Set voice properties
    engine.setProperty('rate', 150)   # Words per minute
    engine.setProperty('volume', 1.0)  # Volume (0.0 to 1.0)
    
    # Define the output file (using .wav for compatibility)
    output_file = os.path.join(
        os.path.expanduser("~"),
        
"Documents/youtube/Agents/4_Voiceover_Audio_Agent/code/voiceover.wav"
    )
    
    # Save the generated speech to the output file
    engine.save_to_file(text, output_file)
    engine.runAndWait()
    
    print("Voiceover saved to", output_file)

if __name__ == '__main__':
    generate_voiceover()

